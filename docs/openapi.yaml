openapi: 3.0.3
info:
  title: PetConnect API
  version: 1.0.0
servers:
  - url: /api/v1
tags:
  - name: AdminAuth
  - name: AdminProfile
  - name: AdminPets
  - name: UserAuth
  - name: UserUploads
components:
  securitySchemes:
    AccessToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Access token returned after login or profile completion.
    SetupToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Setup token returned after OTP verification for onboarding.
  schemas:
    RegisterInput:
      type: object
      required: [name, email, password]
      properties:
        name:
          type: string
          example: Jane Doe
        email:
          type: string
          format: email
          example: jane@example.com
        password:
          type: string
          format: password
          example: Secret123
        phone:
          type: string
          example: "9876543210"
    VerifyEmailInput:
      type: object
      required: [email, otp]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        otp:
          type: string
          example: "123456"
    ResendEmailOtpInput:
      type: object
      required: [email]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
    LoginInput:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        password:
          type: string
          format: password
          example: Secret123
    RefreshTokenInput:
      type: object
      required: [refreshToken]
      properties:
        refreshToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    ForgotPasswordInput:
      type: object
      required: [email]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
    ResetPasswordInput:
      type: object
      required: [email, otp, password]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        otp:
          type: string
          example: "123456"
        password:
          type: string
          format: password
          example: NewSecret123
    CompleteProfileInput:
      type: object
      required: [username, country, avatarUrl]
      properties:
        username:
          type: string
          example: jane_doe
        country:
          type: string
          example: IN
        avatarUrl:
          type: string
          format: uri
          example: https://your-bucket.s3.amazonaws.com/users/avatars/abc.jpg
        favorites:
          type: array
          items:
            type: string
          example: ["dogs", "cats"]
    Location:
      type: object
      properties:
        city:
          type: string
          example: ""
        country:
          type: string
          example: IN
    User:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Jane Doe
        email:
          type: string
          format: email
          example: jane@example.com
        phone:
          type: string
          example: "9876543210"
        role:
          type: string
          example: user
        username:
          type: string
          example: jane_doe
        avatarUrl:
          type: string
          format: uri
        location:
          $ref: "#/components/schemas/Location"
        favorites:
          type: array
          items:
            type: string
        isVerified:
          type: boolean
          example: true
        profileCompleted:
          type: boolean
          example: true
    AuthTokens:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
    AdminLoginInput:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: admin@petconnect.com
        password:
          type: string
          format: password
          example: AdminSecret123
    AdminProfile:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Admin Name
        email:
          type: string
          format: email
          example: admin@petconnect.com
    AdminUpdateProfileInput:
      type: object
      properties:
        name:
          type: string
          example: New Admin Name
        email:
          type: string
          format: email
          example: newadmin@petconnect.com
    PetType:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Dog
        slug:
          type: string
          example: dog
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    PetBreed:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0bb
        name:
          type: string
          example: Labrador
        slug:
          type: string
          example: labrador
        petType:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CreatePetTypeInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Dog
    UpdatePetTypeInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Small Pet
    CreatePetBreedInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Labrador
    UpdatePetBreedInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Golden Retriever
paths:
  /admin/auth/login:
    post:
      tags: [AdminAuth]
      summary: Admin login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminLoginInput"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      tokens:
                        $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Login failed
  /admin/auth/refresh:
    post:
      tags: [AdminAuth]
      summary: Refresh admin tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Tokens refreshed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Refresh failed
  /admin/auth/logout:
    post:
      tags: [AdminAuth]
      summary: Logout admin by revoking refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Logged out
        "400":
          description: Logout failed
  /admin/auth/forgot-password:
    post:
      tags: [AdminAuth]
      summary: Request admin password reset OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordInput"
      responses:
        "200":
          description: OTP sent if email exists
        "400":
          description: Request failed
  /admin/auth/reset-password:
    post:
      tags: [AdminAuth]
      summary: Reset admin password with OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordInput"
      responses:
        "200":
          description: Password reset
        "400":
          description: Reset failed
  /admin/profile:
    get:
      tags: [AdminProfile]
      summary: Get admin profile
      security:
        - AccessToken: []
      responses:
        "200":
          description: Admin profile
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/AdminProfile"
        "401":
          description: Unauthorized
    patch:
      tags: [AdminProfile]
      summary: Update admin profile
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminUpdateProfileInput"
      responses:
        "200":
          description: Profile updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/AdminProfile"
        "400":
          description: Update failed
        "401":
          description: Unauthorized
  /admin/pet-types:
    post:
      tags: [AdminPets]
      summary: Create pet type
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePetTypeInput"
      responses:
        "201":
          description: Pet type created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/PetType"
        "400":
          description: Validation failed
    get:
      tags: [AdminPets]
      summary: Get all pet types
      security:
        - AccessToken: []
      responses:
        "200":
          description: Pet types list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/PetType"
        "401":
          description: Unauthorized
  /admin/pet-types/{id}:
    patch:
      tags: [AdminPets]
      summary: Update pet type
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePetTypeInput"
      responses:
        "200":
          description: Pet type updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/PetType"
        "400":
          description: Validation failed
        "404":
          description: Not found
    delete:
      tags: [AdminPets]
      summary: Delete pet type
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Pet type deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "404":
          description: Not found
  /admin/pet-types/{typeId}/breeds:
    post:
      tags: [AdminPets]
      summary: Create pet breed
      security:
        - AccessToken: []
      parameters:
        - name: typeId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePetBreedInput"
      responses:
        "201":
          description: Pet breed created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/PetBreed"
        "400":
          description: Validation failed
        "404":
          description: Pet type not found
    get:
      tags: [AdminPets]
      summary: Get pet breeds by type
      security:
        - AccessToken: []
      parameters:
        - name: typeId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Pet breeds list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/PetBreed"
        "404":
          description: Pet type not found
  /admin/pet-breeds/{id}:
    patch:
      tags: [AdminPets]
      summary: Update pet breed
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePetBreedInput"
      responses:
        "200":
          description: Pet breed updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/PetBreed"
        "404":
          description: Pet breed not found
    delete:
      tags: [AdminPets]
      summary: Delete pet breed
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Pet breed deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "404":
          description: Pet breed not found
  /auth/register:
    post:
      tags: [UserAuth]
      summary: Register a new user and send email OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterInput"
      responses:
        "201":
          description: OTP sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                      phone:
                        type: string
                      name:
                        type: string
        "400":
          description: Registration failed
  /auth/verify-email:
    post:
      tags: [UserAuth]
      summary: Verify email OTP and get setup token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyEmailInput"
      responses:
        "200":
          description: Email verified
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      needsProfileSetup:
                        type: boolean
                      setupToken:
                        type: string
        "400":
          description: Verification failed
  /auth/resend-email-otp:
    post:
      tags: [UserAuth]
      summary: Resend email OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResendEmailOtpInput"
      responses:
        "200":
          description: OTP resent
        "400":
          description: Resend failed
  /auth/login:
    post:
      tags: [UserAuth]
      summary: Login with email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginInput"
      responses:
        "200":
          description: Login success or profile setup required
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      tokens:
                        $ref: "#/components/schemas/AuthTokens"
                      needsProfileSetup:
                        type: boolean
                      setupToken:
                        type: string
        "400":
          description: Login failed
  /auth/complete-profile:
    post:
      tags: [UserAuth]
      summary: Complete onboarding and receive tokens
      security:
        - SetupToken: []
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompleteProfileInput"
      responses:
        "200":
          description: Profile completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      tokens:
                        $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Profile setup failed
        "401":
          description: Unauthorized
  /auth/refresh:
    post:
      tags: [UserAuth]
      summary: Refresh access and refresh tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Tokens refreshed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Refresh failed
  /auth/logout:
    post:
      tags: [UserAuth]
      summary: Logout by revoking refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Logged out
        "400":
          description: Logout failed
  /auth/forgot-password:
    post:
      tags: [UserAuth]
      summary: Request password reset OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordInput"
      responses:
        "200":
          description: OTP sent if email exists
        "400":
          description: Request failed
  /auth/reset-password:
    post:
      tags: [UserAuth]
      summary: Reset password with OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordInput"
      responses:
        "200":
          description: Password reset
        "400":
          description: Reset failed
  /uploads/user/avatar:
    post:
      tags: [UserUploads]
      summary: Upload user avatar (accepts setup or access token)
      security:
        - SetupToken: []
        - AccessToken: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "201":
          description: Avatar uploaded
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      avatarUrl:
                        type: string
                        format: uri
                      url:
                        type: string
                        format: uri
                      key:
                        type: string
        "400":
          description: Upload failed
        "401":
          description: Unauthorized
